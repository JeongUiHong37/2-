"""
Domain knowledge for steel manufacturing quality analysis system
"""

DOMAIN_KNOWLEDGE = """
=== 제철소 품질 분석 도메인 지식 ===

## 핵심 지표 정의

### 품질부적합 관련
- 품질부적합률 = (품질부적합발생량 / 제품생산량) × 100
- 품질부적합발생량(QLY_INC_HPW): 품질 기준에 미달하는 제품의 중량
- 제품생산량(TR_F_PRODQUANTITY): 총 생산된 제품의 중량

### 공정 구분
- 발생공정(QLY_INC_HPN_FAC_TP_NM): 품질부적합이 실제로 발생한 공정
- 책임공정(QLY_INC_RESP_FAC_TP_NM): 품질부적합에 대한 책임이 있는 공정

### 품종그룹
- 냉연: 냉간압연강판
- 열연: 열간압연강판  
- 후판: 두꺼운 강판
- 전기강판: 전기기기용 강판
- 선재: 철사 원료용 강재
- 도금: 아연도금강판

### 품질부적합 원인
- Build Up: 롤에 이물질이 붙어서 발생하는 표면결함
- Dust: 먼지나 이물질로 인한 표면오염
- Edge burr: 가장자리 버 (날카로운 돌기)
- Black Line: 검은 선 형태의 표면결함
- UST불량: 초음파검사 불량
- Crack: 균열
- 두께불량: 규격 두께 미달
- 폭불량: 규격 폭 미달
- 양파: 표면 박리 현상
- Edge파손: 가장자리 손상
- Scab: 표면 스케일 결함
- 부푼흠: 표면이 부푼 결함
- 겹침흠: 겹침으로 인한 결함
- 단중미달: 중량 부족
- 딱지흠: 딱지 모양 표면결함
- Blow Hole: 기공 결함

### 고객사 구분
- A고객사, B고객사, C고객사, D고객사, E고객사: 각각 다른 최종 고객

### 클레임 관련
- RMA_QTY: 클레임 보상금액 (원)
- 클레임률 = (클레임 보상금액 / 매출액) × 100

### 분석 기준
- 기본 분석 기간: 최근 3개월
- 트렌드 분석: 월별 또는 일별
- 비교 분석: 공정별, 품종별, 고객사별 가능

### 주요 KPI
1. 품질부적합률 목표: 5% 이하
2. 클레임률 목표: 1% 이하  
3. 주요 관리 품종: 후판, 냉연, 열연
4. 중점 관리 원인: UST불량, Build Up, Dust

### 분석 우선순위
1. 후판 UST불량 (가장 심각한 품질이슈)
2. 발생공정별 불량률 트렌드
3. 고객사별 클레임 현황
4. 품종별 계절성 분석
"""

def get_concept_definition(query: str) -> str:
    """Extract concept definitions from domain knowledge based on query"""
    
    query_lower = query.lower()
    
    # Define concept mappings
    concepts = {
        'ust불량': 'UST불량: 초음파검사 불량. 내부 결함을 검출하는 초음파 검사에서 기준을 만족하지 못하는 경우입니다.',
        'build up': 'Build Up: 롤에 이물질이 붙어서 발생하는 표면결함. 압연 과정에서 롤 표면에 금속이나 이물질이 부착되어 제품 표면에 요철을 만드는 현상입니다.',
        'dust': 'Dust: 먼지나 이물질로 인한 표면오염. 제조 과정에서 먼지가 제품 표면에 부착되어 품질을 저하시키는 결함입니다.',
        '품질부적합률': '품질부적합률 = (품질부적합발생량 / 제품생산량) × 100. 전체 생산량 대비 품질 기준에 미달하는 제품의 비율을 나타내는 핵심 품질 지표입니다.',
        '클레임률': '클레임률 = (클레임 보상금액 / 매출액) × 100. 매출 대비 고객 클레임으로 인한 보상금액의 비율을 나타냅니다.',
        '발생공정': '발생공정(QLY_INC_HPN_FAC_TP_NM): 품질부적합이 실제로 발생한 공정을 의미합니다.',
        '책임공정': '책임공정(QLY_INC_RESP_FAC_TP_NM): 품질부적합에 대한 책임이 있는 공정을 의미합니다.',
        '냉연': '냉연: 냉간압연강판. 상온에서 압연하여 만든 얇은 강판으로 표면이 매끄럽고 치수 정밀도가 높습니다.',
        '열연': '열연: 열간압연강판. 고온에서 압연하여 만든 강판으로 두께가 두껍고 구조용으로 많이 사용됩니다.',
        '후판': '후판: 두꺼운 강판. 일반적으로 6mm 이상의 두꺼운 강판으로 조선, 건설, 중공업 등에 사용됩니다.',
        '전기강판': '전기강판: 전기기기용 강판. 변압기, 모터 등 전기기기의 철심으로 사용되는 특수강판입니다.',
        '선재': '선재: 철사 원료용 강재. 철사, 볼트, 너트 등을 만들기 위한 원료로 사용되는 봉강입니다.',
        '도금': '도금: 아연도금강판. 강판 표면에 아연을 도금하여 내식성을 향상시킨 제품입니다.',
        'edge burr': 'Edge burr: 가장자리 버. 절단이나 압연 과정에서 가장자리에 생기는 날카로운 돌기로 안전사고의 원인이 될 수 있습니다.',
        'black line': 'Black Line: 검은 선 형태의 표면결함. 압연 과정에서 롤이나 이물질에 의해 제품 표면에 생기는 검은 선 모양의 결함입니다.',
        'crack': 'Crack: 균열. 제품에 발생하는 갈라짐으로 구조적 강도를 저하시키는 심각한 결함입니다.',
        '두께불량': '두께불량: 규격 두께 미달. 고객이 요구하는 두께 규격을 만족하지 못하는 경우입니다.',
        '폭불량': '폭불량: 규격 폭 미달. 고객이 요구하는 폭 규격을 만족하지 못하는 경우입니다.',
        '양파': '양파: 표면 박리 현상. 강판 표면이 양파껍질처럼 벗겨지는 결함으로 표면 품질을 저하시킵니다.'
    }
    
    # Find matching concepts
    for key, definition in concepts.items():
        if key in query_lower:
            return definition
    
    # If no direct match, return general information
    if '품질' in query_lower or '부적합' in query_lower:
        return """품질부적합이란 제품이 규정된 품질 기준을 만족하지 못하는 상태를 말합니다. 
주요 측정 지표로는 품질부적합률(불량률)이 있으며, 이는 (품질부적합발생량 / 제품생산량) × 100으로 계산됩니다.
목표 기준은 5% 이하입니다."""
    
    elif '클레임' in query_lower:
        return """클레임은 고객이 제품 품질에 대해 제기하는 불만이나 보상 요구를 의미합니다.
클레임률은 (클레임 보상금액 / 매출액) × 100으로 계산되며, 목표 기준은 1% 이하입니다."""
    
    return None
